"use client";

import { useState, useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { Progress } from '@/components/ui/progress';
import { Separator } from '@/components/ui/separator';
import { ScrollArea } from '@/components/ui/scroll-area';
import { ThemeToggle } from '@/components/theme-toggle';
import AIAnalytics from '@/components/ai-analytics';
import DataExport from '@/components/data-export';
import { 
  Server, 
  Globe, 
  Activity, 
  AlertTriangle, 
  CheckCircle, 
  XCircle,
  Zap,
  Database,
  Webhook,
  GitBranch,
  BarChart3,
  Settings,
  Plus,
  RefreshCw,
  Play,
  Pause,
  Eye,
  Edit,
  Trash2,
  Clock,
  TrendingUp,
  TrendingDown,
  Cpu,
  HardDrive,
  Wifi,
  WifiOff,
  Shield,
  Bell,
  Filter,
  Search,
  Download,
  Upload,
  Package,
  Layers,
  Network,
  Radio,
  Brain,
  Users,
  FileText,
  Calendar,
  MapPin,
  Terminal
} from 'lucide-react';

// Types
interface ServerMonitor {
  id: string;
  name: string;
  host: string;
  port: number;
  type: string;
  status: 'online' | 'offline' | 'warning';
  responseTime: number;
  cpu: number;
  memory: number;
  disk: number;
  uptime: string;
  lastCheck: string;
  tags: string[];
  location?: string;
  os?: string;
  version?: string;
}

interface Application {
  id: string;
  name: string;
  type: string;
  endpoint: string;
  status: 'healthy' | 'unhealthy' | 'warning';
  responseTime: number;
  uptime: number;
  lastCheck: string;
  serverId: string;
  serverName: string;
  tags: string[];
  version?: string;
  framework?: string;
}

interface ApiEndpoint {
  id: string;
  name: string;
  url: string;
  method: string;
  status: number;
  responseTime: number;
  lastChecked: string;
  success: boolean;
  applicationId: string;
  applicationName: string;
  headers?: Record<string, string>;
  body?: string;
}

interface WebhookMonitor {
  id: string;
  name: string;
  url: string;
  events: string[];
  status: 'active' | 'inactive' | 'error';
  lastTrigger: string;
  deliveries: number;
  successRate: number;
  applicationId: string;
  applicationName: string;
  secret?: string;
}

interface MetricData {
  timestamp: string;
  value: number;
  label: string;
}

interface WorkflowExecution {
  id: string;
  name: string;
  status: 'running' | 'completed' | 'failed' | 'pending';
  startedAt: string;
  duration: string;
  progress: number;
  steps: Array<{
    name: string;
    status: 'pending' | 'running' | 'completed' | 'failed';
    duration?: string;
  }>;
}

interface AlertItem {
  id: string;
  title: string;
  severity: 'low' | 'medium' | 'high' | 'critical';
  message: string;
  timestamp: string;
  acknowledged: boolean;
  source: string;
}

interface TeamMember {
  id: string;
  name: string;
  email: string;
  role: string;
  status: 'online' | 'offline' | 'busy';
  avatar?: string;
}

export default function OperationsDashboard() {
  const [activeTab, setActiveTab] = useState('overview');
  const [servers, setServers] = useState<ServerMonitor[]>([]);
  const [applications, setApplications] = useState<Application[]>([]);
  const [apiEndpoints, setApiEndpoints] = useState<ApiEndpoint[]>([]);
  const [webhooks, setWebhooks] = useState<WebhookMonitor[]>([]);
  const [workflows, setWorkflows] = useState<WorkflowExecution[]>([]);
  const [alerts, setAlerts] = useState<AlertItem[]>([]);
  const [metrics, setMetrics] = useState<MetricData[]>([]);
  const [teamMembers, setTeamMembers] = useState<TeamMember[]>([]);
  const [isRefreshing, setIsRefreshing] = useState(false);
  const [selectedServer, setSelectedServer] = useState<string | null>(null);
  const [searchTerm, setSearchTerm] = useState('');
  const [filterStatus, setFilterStatus] = useState('all');
  const [autoRefresh, setAutoRefresh] = useState(true);
  const [refreshInterval, setRefreshInterval] = useState(30000);
  const [selectedAlert, setSelectedAlert] = useState<AlertItem | null>(null);
  const [showAlertDetails, setShowAlertDetails] = useState(false);
  const [showAppForm, setShowAppForm] = useState(false);
  const [showServerForm, setShowServerForm] = useState(false);
  const [showEndpointForm, setShowEndpointForm] = useState(false);
  const [showWebhookForm, setShowWebhookForm] = useState(false);
  const [showTeamMemberForm, setShowTeamMemberForm] = useState(false);

  const [newApp, setNewApp] = useState({
    name: '',
    description: '',
    version: '',
    status: 'active' as const,
    repository: '',
    healthCheckUrl: '',
    healthCheckInterval: 60,
    responseTimeThreshold: 5000,
    errorRateThreshold: 5,
    owner: '',
    environment: 'production' as const,
    tags: ''
  });

  const [newServer, setNewServer] = useState({
    name: '',
    host: '',
    port: 80,
    type: 'web' as const,
    status: 'online' as const,
    description: '',
    cpuCores: 4,
    memory: 16,
    storage: 500,
    healthCheckUrl: '',
    healthCheckInterval: 60,
    responseTimeThreshold: 1000,
    cpuThreshold: 80,
    memoryThreshold: 85,
    diskThreshold: 90,
    tags: ''
  });

  const [newEndpoint, setNewEndpoint] = useState({
    name: '',
    url: '',
    method: 'GET' as const,
    applicationId: '',
    status: 'active' as const,
    expectedStatus: 200,
    timeout: 30000,
    checkInterval: 300,
    description: '',
    headers: '',
    authentication: 'none' as const,
    alertThreshold: 5
  });

  const [newWebhook, setNewWebhook] = useState({
    name: '',
    url: '',
    events: [] as string[],
    secret: '',
    active: true,
    retryAttempts: 3,
    timeout: 30000,
    description: '',
    headers: '',
    applicationId: ''
  });

  const [newTeamMember, setNewTeamMember] = useState({
    name: '',
    email: '',
    role: 'member' as const,
    department: '',
    permissions: [] as string[]
  });

  // Initialize with mock data
  useEffect(() => {
    loadMonitoringData();
    if (autoRefresh) {
      const interval = setInterval(loadMonitoringData, refreshInterval);
      return () => clearInterval(interval);
    }
  }, [autoRefresh, refreshInterval]);

  const loadMonitoringData = async () => {
    try {
      // Simulate API calls
      await Promise.all([
        loadServers(),
        loadApplications(),
        loadApiEndpoints(),
        loadWebhooks(),
        loadWorkflows(),
        loadAlerts(),
        loadMetrics(),
        loadTeamMembers()
      ]);
    } catch (error) {
      console.error('Error loading monitoring data:', error);
    }
  };

  const loadServers = async () => {
    try {
      const response = await fetch('/api/servers');
      if (!response.ok) throw new Error('Failed to fetch servers');
      
      const serversData = await response.json();
      
      // Transform API data to match interface
      const transformedServers: ServerMonitor[] = serversData.map((server: any) => ({
        id: server.id,
        name: server.name,
        host: server.host,
        port: server.port,
        type: server.type,
        status: server.healthChecks?.[0]?.status?.toLowerCase() || 'offline',
        responseTime: server.healthChecks?.[0]?.responseTime || 0,
        cpu: server.metrics?.[0]?.cpu || Math.floor(Math.random() * 100),
        memory: server.metrics?.[0]?.memory || Math.floor(Math.random() * 100),
        disk: server.metrics?.[0]?.disk || Math.floor(Math.random() * 100),
        uptime: server.healthChecks?.[0]?.uptime || '0d 0h 0m',
        lastCheck: server.healthChecks?.[0]?.timestamp || new Date().toISOString(),
        tags: server.tags ? JSON.parse(server.tags) : [],
        location: server.description || 'Unknown',
        os: server.type,
        version: server.type
      }));
      
      setServers(transformedServers);
    } catch (error) {
      console.error('Error loading servers:', error);
      // Fallback to mock data if API fails
      const serverData: ServerMonitor[] = [
        {
          id: '1',
          name: 'Production Web Server',
          host: 'prod-server-01.example.com',
          port: 443,
          type: 'HTTPS',
          status: 'online',
          responseTime: 45,
          cpu: 67,
          memory: 72,
          disk: 45,
          uptime: '15d 8h 23m',
          lastCheck: new Date().toISOString(),
          tags: ['production', 'web', 'critical'],
          location: 'US East',
          os: 'Ubuntu 22.04',
          version: 'nginx/1.18.0'
        }
      ];
      setServers(serverData);
    }
  };

  const loadApplications = async () => {
    try {
      const response = await fetch('/api/applications');
      if (!response.ok) throw new Error('Failed to fetch applications');
      
      const applicationsData = await response.json();
      
      // Transform API data to match interface
      const transformedApplications: Application[] = applicationsData.map((app: any) => ({
        id: app.id,
        name: app.name,
        type: app.type,
        endpoint: app.endpoint,
        status: app.healthChecks?.[0]?.status?.toLowerCase() || 'unhealthy',
        responseTime: app.healthChecks?.[0]?.responseTime || Math.floor(Math.random() * 1000),
        uptime: app.healthChecks?.[0]?.uptime || Math.random() * 100,
        lastCheck: app.healthChecks?.[0]?.timestamp || new Date().toISOString(),
        serverId: app.serverId,
        serverName: app.server?.name || 'Unknown Server',
        tags: app.tags ? JSON.parse(app.tags) : [],
        version: app.version || '1.0.0',
        framework: app.type
      }));
      
      setApplications(transformedApplications);
    } catch (error) {
      console.error('Error loading applications:', error);
      // Fallback to mock data if API fails
      const appData: Application[] = [
        {
          id: '1',
          name: 'E-Commerce Frontend',
          type: 'WEB',
          endpoint: 'https://shop.example.com',
          status: 'healthy',
          responseTime: 234,
          uptime: 99.8,
          lastCheck: new Date().toISOString(),
          serverId: '1',
          serverName: 'Production Web Server',
          tags: ['frontend', 'react', 'commerce'],
          version: '2.4.1',
          framework: 'Next.js 14'
        }
      ];
      setApplications(appData);
    }
  };

  const loadApiEndpoints = async () => {
    try {
      const response = await fetch('/api/api-endpoints');
      if (!response.ok) throw new Error('Failed to fetch API endpoints');
      
      const endpointsData = await response.json();
      
      // Transform API data to match interface
      const transformedEndpoints: ApiEndpoint[] = endpointsData.map((endpoint: any) => ({
        id: endpoint.id,
        name: endpoint.name,
        url: endpoint.url,
        method: endpoint.method,
        status: endpoint.responses?.[0]?.status || 200,
        responseTime: endpoint.responses?.[0]?.responseTime || Math.floor(Math.random() * 1000),
        lastChecked: endpoint.responses?.[0]?.timestamp || new Date().toISOString(),
        success: (endpoint.responses?.[0]?.status || 200) < 400,
        applicationId: endpoint.applicationId,
        applicationName: endpoint.application?.name || 'Unknown Application',
        headers: endpoint.headers ? JSON.parse(endpoint.headers) : {},
        body: endpoint.body
      }));
      
      setApiEndpoints(transformedEndpoints);
    } catch (error) {
      console.error('Error loading API endpoints:', error);
      // Fallback to mock data if API fails
      const endpointData: ApiEndpoint[] = [
        {
          id: '1',
          name: 'Get User Profile',
          url: 'https://api.example.com/users/{id}',
          method: 'GET',
          status: 200,
          responseTime: 145,
          lastChecked: new Date().toISOString(),
          success: true,
          applicationId: '3',
          applicationName: 'User Service',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer ***'
          }
        }
      ];
      setApiEndpoints(endpointData);
    }
  };

  const loadWebhooks = async () => {
    try {
      const response = await fetch('/api/webhooks');
      if (!response.ok) throw new Error('Failed to fetch webhooks');
      
      const webhooksData = await response.json();
      
      // Transform API data to match interface
      const transformedWebhooks: WebhookMonitor[] = webhooksData.map((webhook: any) => {
        const deliveries = webhook.deliveries || [];
        const successfulDeliveries = deliveries.filter((d: any) => d.status === 'SUCCESS').length;
        const successRate = deliveries.length > 0 ? (successfulDeliveries / deliveries.length) * 100 : 100;
        
        return {
          id: webhook.id,
          name: webhook.name,
          url: webhook.url,
          events: webhook.events ? JSON.parse(webhook.events) : [],
          status: webhook.isActive ? 'active' : 'inactive',
          lastTrigger: webhook.lastTrigger || new Date().toISOString(),
          deliveries: deliveries.length,
          successRate: Math.round(successRate * 10) / 10,
          applicationId: webhook.applicationId,
          applicationName: webhook.application?.name || 'Unknown Application',
          secret: webhook.secret ? 'whsec_***' : undefined
        };
      });
      
      setWebhooks(transformedWebhooks);
    } catch (error) {
      console.error('Error loading webhooks:', error);
      // Fallback to mock data if API fails
      const webhookData: WebhookMonitor[] = [
        {
          id: '1',
          name: 'Payment Events',
          url: 'https://webhook.example.com/payments',
          events: ['payment.success', 'payment.failed', 'payment.refunded'],
          status: 'active',
          lastTrigger: new Date().toISOString(),
          deliveries: 1247,
          successRate: 98.7,
          applicationId: '2',
          applicationName: 'Payment API',
          secret: 'whsec_***'
        }
      ];
      setWebhooks(webhookData);
    }
  };

  const loadWorkflows = async () => {
    try {
      const response = await fetch('/api/workflows');
      if (!response.ok) throw new Error('Failed to fetch workflows');
      
      const workflowsData = await response.json();
      
      // Transform API data to match interface
      const transformedWorkflows: WorkflowExecution[] = workflowsData.map((workflow: any) => {
        const latestExecution = workflow.executions?.[0];
        return {
          id: workflow.id,
          name: workflow.name,
          status: latestExecution?.status?.toLowerCase() as 'running' | 'completed' | 'failed' | 'pending' || 'pending',
          startedAt: latestExecution?.startedAt || new Date().toISOString(),
          duration: latestExecution?.duration || '0m 0s',
          progress: latestExecution?.progress || 0,
          steps: latestExecution?.steps?.map((step: any) => ({
            name: step.name,
            status: step.status?.toLowerCase() as 'pending' | 'running' | 'completed' | 'failed',
            duration: step.duration
          })) || []
        };
      });
      
      setWorkflows(transformedWorkflows);
    } catch (error) {
      console.error('Error loading workflows:', error);
      // Fallback to mock data if API fails
      const workflowData: WorkflowExecution[] = [
        {
          id: '1',
          name: 'Daily Backup',
          status: 'running',
          startedAt: new Date().toISOString(),
          duration: '12m 34s',
          progress: 67,
          steps: [
            { name: 'Database Dump', status: 'completed', duration: '8m 12s' },
            { name: 'Compress Files', status: 'completed', duration: '2m 45s' },
            { name: 'Upload to S3', status: 'running' },
            { name: 'Cleanup Old Backups', status: 'pending' }
          ]
        }
      ];
      setWorkflows(workflowData);
    }
  };

  const loadAlerts = async () => {
    try {
      const response = await fetch('/api/alerts');
      if (!response.ok) throw new Error('Failed to fetch alerts');
      
      const alertsData = await response.json();
      
      // Transform API data to match interface
      const transformedAlerts: AlertItem[] = alertsData.map((alert: any) => ({
        id: alert.id,
        title: alert.name,
        severity: alert.severity.toLowerCase() as 'low' | 'medium' | 'high' | 'critical',
        message: alert.description,
        timestamp: alert.createdAt,
        acknowledged: !!alert.acknowledgedAt,
        source: alert.user?.name || 'System'
      }));
      
      setAlerts(transformedAlerts);
    } catch (error) {
      console.error('Error loading alerts:', error);
      // Fallback to mock data if API fails
      const alertData: AlertItem[] = [
        {
          id: '1',
          title: 'High CPU Usage',
          severity: 'high',
          message: 'Database server CPU usage is above 85% for more than 10 minutes',
          timestamp: new Date(Date.now() - 300000).toISOString(),
          acknowledged: false,
          source: 'db-primary.example.com'
        }
      ];
      setAlerts(alertData);
    }
  };

  const loadMetrics = async () => {
    try {
      const response = await fetch('/api/metrics?timeRange=1h&limit=30');
      if (!response.ok) throw new Error('Failed to fetch metrics');
      
      const metricsData = await response.json();
      
      // Transform API data to match interface
      const transformedMetrics: MetricData[] = metricsData.map((metric: any) => ({
        timestamp: metric.timestamp,
        value: metric.value,
        label: metric.name
      }));
      
      setMetrics(transformedMetrics);
    } catch (error) {
      console.error('Error loading metrics:', error);
      // Fallback to mock data if API fails
      const now = new Date();
      const mockMetrics: MetricData[] = [];
      for (let i = 29; i >= 0; i--) {
        const timestamp = new Date(now.getTime() - i * 60000);
        mockMetrics.push({
          timestamp: timestamp.toISOString(),
          value: Math.floor(Math.random() * 100) + 50,
          label: 'Response Time'
        });
      }
      setMetrics(mockMetrics);
    }
  };

  const loadTeamMembers = async () => {
    try {
      const response = await fetch('/api/team');
      if (!response.ok) throw new Error('Failed to fetch team members');
      
      const teamData = await response.json();
      
      // Transform API data to match interface
      const transformedTeam: TeamMember[] = teamData.map((member: any) => ({
        id: member.id,
        name: member.name,
        email: member.email,
        role: member.role || 'Team Member',
        status: member.status || 'offline',
        avatar: member.avatar
      }));
      
      setTeamMembers(transformedTeam);
    } catch (error) {
      console.error('Error loading team members:', error);
      // Fallback to mock data if API fails
      const teamData: TeamMember[] = [
        {
          id: '1',
          name: 'Alex Johnson',
          email: 'alex@example.com',
          role: 'DevOps Engineer',
          status: 'online'
        },
        {
          id: '2',
          name: 'Sarah Chen',
          email: 'sarah@example.com',
          role: 'System Administrator',
          status: 'busy'
        },
        {
          id: '3',
          name: 'Mike Wilson',
          email: 'mike@example.com',
          role: 'Developer',
          status: 'offline'
        }
      ];
      setTeamMembers(teamData);
    }
  };

  const handleRefresh = () => {
    setIsRefreshing(true);
    setTimeout(() => {
      loadMonitoringData();
      setIsRefreshing(false);
    }, 1000);
  };

  const handleAcknowledgeAlert = async (alertId: string) => {
    try {
      const alert = alerts.find(a => a.id === alertId);
      if (!alert) return;
      
      const response = await fetch('/api/alerts', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          id: alertId,
          isTriggered: false,
          acknowledgedAt: new Date().toISOString(),
          acknowledgedBy: 'current-user'
        })
      });
      
      if (response.ok) {
        setAlerts(alerts.map(alert => 
          alert.id === alertId 
            ? { ...alert, acknowledged: true }
            : alert
        ));
      }
    } catch (error) {
      console.error('Error acknowledging alert:', error);
    }
  };

  const handleServerAction = async (serverId: string, action: string) => {
    try {
      switch (action) {
        case 'delete':
          const deleteResponse = await fetch(`/api/servers?id=${serverId}`, {
            method: 'DELETE'
          });
          if (deleteResponse.ok) {
            await loadServers(); // Refresh the servers list
          }
          break;
        case 'restart':
        case 'stop':
        case 'start':
          // These would be implemented with actual server management logic
          console.log(`Performing ${action} on server ${serverId}`);
          break;
      }
    } catch (error) {
      console.error(`Error performing ${action} on server ${serverId}:`, error);
    }
  };

  const handleAddServer = async (serverData: any) => {
    try {
      const response = await fetch('/api/servers', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(serverData)
      });
      
      if (response.ok) {
        await loadServers(); // Refresh the servers list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error adding server:', error);
      return false;
    }
  };

  const handleUpdateServer = async (serverData: any) => {
    try {
      const response = await fetch('/api/servers', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(serverData)
      });
      
      if (response.ok) {
        await loadServers(); // Refresh the servers list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error updating server:', error);
      return false;
    }
  };

  // Alert details handler
  const handleAlertClick = (alert: AlertItem) => {
    setSelectedAlert(alert);
    setShowAlertDetails(true);
  };

  // Form submission handlers
  const handleAddApplication = async () => {
    try {
      const response = await fetch('/api/applications', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          ...newApp,
          tags: newApp.tags.split(',').map(tag => tag.trim()).filter(Boolean)
        })
      });
      
      if (response.ok) {
        await loadApplications();
        setShowAppForm(false);
        setNewApp({
          name: '',
          description: '',
          version: '',
          status: 'active',
          repository: '',
          healthCheckUrl: '',
          healthCheckInterval: 60,
          responseTimeThreshold: 5000,
          errorRateThreshold: 5,
          owner: '',
          environment: 'production',
          tags: ''
        });
      }
    } catch (error) {
      console.error('Error adding application:', error);
    }
  };

  const handleAddServerSubmit = async () => {
    try {
      const response = await fetch('/api/servers', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          ...newServer,
          tags: newServer.tags.split(',').map(tag => tag.trim()).filter(Boolean)
        })
      });
      
      if (response.ok) {
        await loadServers();
        setShowServerForm(false);
        setNewServer({
          name: '',
          host: '',
          port: 80,
          type: 'web',
          status: 'online',
          description: '',
          cpuCores: 4,
          memory: 16,
          storage: 500,
          healthCheckUrl: '',
          healthCheckInterval: 60,
          responseTimeThreshold: 1000,
          cpuThreshold: 80,
          memoryThreshold: 85,
          diskThreshold: 90,
          tags: ''
        });
      }
    } catch (error) {
      console.error('Error adding server:', error);
    }
  };

  const handleAddEndpoint = async () => {
    try {
      const response = await fetch('/api/api-endpoints', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          ...newEndpoint,
          headers: newEndpoint.headers ? JSON.parse(newEndpoint.headers) : {}
        })
      });
      
      if (response.ok) {
        await loadApiEndpoints();
        setShowEndpointForm(false);
        setNewEndpoint({
          name: '',
          url: '',
          method: 'GET',
          applicationId: '',
          status: 'active',
          expectedStatus: 200,
          timeout: 30000,
          checkInterval: 300,
          description: '',
          headers: '',
          authentication: 'none',
          alertThreshold: 5
        });
      }
    } catch (error) {
      console.error('Error adding endpoint:', error);
    }
  };

  const handleAddWebhook = async () => {
    try {
      const response = await fetch('/api/webhooks', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          ...newWebhook,
          events: JSON.stringify(newWebhook.events),
          headers: newWebhook.headers ? JSON.parse(newWebhook.headers) : {}
        })
      });
      
      if (response.ok) {
        await loadWebhooks();
        setShowWebhookForm(false);
        setNewWebhook({
          name: '',
          url: '',
          events: [],
          secret: '',
          active: true,
          retryAttempts: 3,
          timeout: 30000,
          description: '',
          headers: '',
          applicationId: ''
        });
      }
    } catch (error) {
      console.error('Error adding webhook:', error);
    }
  };

  const handleAddTeamMember = async () => {
    try {
      const response = await fetch('/api/team', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          ...newTeamMember,
          permissions: JSON.stringify(newTeamMember.permissions)
        })
      });
      
      if (response.ok) {
        await loadTeamMembers();
        setShowTeamMemberForm(false);
        setNewTeamMember({
          name: '',
          email: '',
          role: 'member',
          department: '',
          permissions: []
        });
      }
    } catch (error) {
      console.error('Error adding team member:', error);
    }
  };

  const handleApiTest = (endpointId: string) => {
    console.log(`Testing API endpoint ${endpointId}`);
    // Implement API testing
  };

  const handleUpdateApplication = async (appData: any) => {
    try {
      const response = await fetch('/api/applications', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(appData)
      });
      
      if (response.ok) {
        await loadApplications(); // Refresh the applications list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error updating application:', error);
      return false;
    }
  };

  const handleDeleteApplication = async (appId: string) => {
    try {
      const response = await fetch(`/api/applications?id=${appId}`, {
        method: 'DELETE'
      });
      
      if (response.ok) {
        await loadApplications(); // Refresh the applications list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error deleting application:', error);
      return false;
    }
  };

  const handleAddAlert = async (alertData: any) => {
    try {
      const response = await fetch('/api/alerts', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(alertData)
      });
      
      if (response.ok) {
        await loadAlerts(); // Refresh the alerts list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error adding alert:', error);
      return false;
    }
  };

  const handleUpdateAlert = async (alertData: any) => {
    try {
      const response = await fetch('/api/alerts', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(alertData)
      });
      
      if (response.ok) {
        await loadAlerts(); // Refresh the alerts list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error updating alert:', error);
      return false;
    }
  };

  const handleDeleteAlert = async (alertId: string) => {
    try {
      const response = await fetch(`/api/alerts?id=${alertId}`, {
        method: 'DELETE'
      });
      
      if (response.ok) {
        await loadAlerts(); // Refresh the alerts list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error deleting alert:', error);
      return false;
    }
  };

  const handleAddWorkflow = async (workflowData: any) => {
    try {
      const response = await fetch('/api/workflows', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(workflowData)
      });
      
      if (response.ok) {
        await loadWorkflows(); // Refresh the workflows list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error adding workflow:', error);
      return false;
    }
  };

  const handleUpdateWorkflow = async (workflowData: any) => {
    try {
      const response = await fetch('/api/workflows', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(workflowData)
      });
      
      if (response.ok) {
        await loadWorkflows(); // Refresh the workflows list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error updating workflow:', error);
      return false;
    }
  };

  const handleDeleteWorkflow = async (workflowId: string) => {
    try {
      const response = await fetch(`/api/workflows?id=${workflowId}`, {
        method: 'DELETE'
      });
      
      if (response.ok) {
        await loadWorkflows(); // Refresh the workflows list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error deleting workflow:', error);
      return false;
    }
  };

  const handleAddApiEndpoint = async (endpointData: any) => {
    try {
      const response = await fetch('/api/api-endpoints', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(endpointData)
      });
      
      if (response.ok) {
        await loadApiEndpoints(); // Refresh the endpoints list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error adding API endpoint:', error);
      return false;
    }
  };

  const handleUpdateApiEndpoint = async (endpointData: any) => {
    try {
      const response = await fetch('/api/api-endpoints', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(endpointData)
      });
      
      if (response.ok) {
        await loadApiEndpoints(); // Refresh the endpoints list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error updating API endpoint:', error);
      return false;
    }
  };

  const handleDeleteApiEndpoint = async (endpointId: string) => {
    try {
      const response = await fetch(`/api/api-endpoints?id=${endpointId}`, {
        method: 'DELETE'
      });
      
      if (response.ok) {
        await loadApiEndpoints(); // Refresh the endpoints list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error deleting API endpoint:', error);
      return false;
    }
  };

  const handleAddWebhook = async (webhookData: any) => {
    try {
      const response = await fetch('/api/webhooks', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(webhookData)
      });
      
      if (response.ok) {
        await loadWebhooks(); // Refresh the webhooks list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error adding webhook:', error);
      return false;
    }
  };

  const handleUpdateWebhook = async (webhookData: any) => {
    try {
      const response = await fetch('/api/webhooks', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(webhookData)
      });
      
      if (response.ok) {
        await loadWebhooks(); // Refresh the webhooks list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error updating webhook:', error);
      return false;
    }
  };

  const handleDeleteWebhook = async (webhookId: string) => {
    try {
      const response = await fetch(`/api/webhooks?id=${webhookId}`, {
        method: 'DELETE'
      });
      
      if (response.ok) {
        await loadWebhooks(); // Refresh the webhooks list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error deleting webhook:', error);
      return false;
    }
  };

  const handleAddTeamMember = async (memberData: any) => {
    try {
      const response = await fetch('/api/team', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(memberData)
      });
      
      if (response.ok) {
        await loadTeamMembers(); // Refresh the team list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error adding team member:', error);
      return false;
    }
  };

  const handleUpdateTeamMember = async (memberData: any) => {
    try {
      const response = await fetch('/api/team', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(memberData)
      });
      
      if (response.ok) {
        await loadTeamMembers(); // Refresh the team list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error updating team member:', error);
      return false;
    }
  };

  const handleDeleteTeamMember = async (memberId: string) => {
    try {
      const response = await fetch(`/api/team?id=${memberId}`, {
        method: 'DELETE'
      });
      
      if (response.ok) {
        await loadTeamMembers(); // Refresh the team list
        return true;
      }
      return false;
    } catch (error) {
      console.error('Error deleting team member:', error);
      return false;
    }
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'online':
      case 'healthy':
      case 'active':
      case 'completed':
        return 'text-green-600';
      case 'warning':
      case 'unhealthy':
      case 'running':
        return 'text-yellow-600';
      case 'offline':
      case 'error':
      case 'failed':
      case 'critical':
        return 'text-red-600';
      default:
        return 'text-gray-600';
    }
  };

  const getStatusIcon = (status: string) => {
    switch (status) {
      case 'online':
      case 'healthy':
      case 'active':
      case 'completed':
        return <CheckCircle className="w-4 h-4" />;
      case 'warning':
      case 'unhealthy':
      case 'running':
        return <AlertTriangle className="w-4 h-4" />;
      case 'offline':
      case 'error':
      case 'failed':
      case 'critical':
        return <XCircle className="w-4 h-4" />;
      default:
        return <Activity className="w-4 h-4" />;
    }
  };

  const getSeverityColor = (severity: string) => {
    switch (severity) {
      case 'critical': return 'destructive';
      case 'high': return 'destructive';
      case 'medium': return 'default';
      case 'low': return 'secondary';
      default: return 'outline';
    }
  };

  const overallHealth = Math.round(
    (servers.filter(s => s.status === 'online').length / servers.length) * 100
  );

  const criticalAlerts = alerts.filter(a => a.severity === 'critical' && !a.acknowledged).length;

  return (
    <div className="min-h-screen">
      {/* Header */}
      <div className="glass-morphism sticky top-0 z-50 border-b border-card-border">
        <div className="max-w-7xl mx-auto px-4 py-4">
          <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
            <div className="flex items-center gap-4">
              <div className="flex items-center gap-2">
                <div className="p-2 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 glow-effect">
                  <Activity className="w-6 h-6 text-white" />
                </div>
                <div>
                  <h1 className="text-2xl font-bold bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent">FinSec Operations</h1>
                  <p className="text-sm text-muted-foreground">Universal Semantic Framework</p>
                </div>
              </div>
              {criticalAlerts > 0 && (
                <Badge className="status-offline pulse-animation">
                  <Bell className="w-3 h-3 mr-1" />
                  {criticalAlerts} Critical
                </Badge>
              )}
            </div>
            <div className="flex items-center gap-3">
              <div className="glass-morphism rounded-lg px-3 py-2 flex items-center gap-2">
                <Search className="w-4 h-4 text-muted-foreground" />
                <input
                  type="text"
                  placeholder="Search systems..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="bg-transparent border-none outline-none text-sm placeholder-muted-foreground w-48"
                />
              </div>
              <Button
                variant="outline"
                size="sm"
                onClick={handleRefresh}
                disabled={isRefreshing}
                className="glass-morphism-hover"
              >
                <RefreshCw className={`w-4 h-4 mr-2 ${isRefreshing ? 'animate-spin' : ''}`} />
                Refresh
              </Button>
              <ThemeToggle />
            </div>
          </div>
        </div>
      </div>

      <div className="max-w-7xl mx-auto p-4 space-y-6">
        {/* Overview Cards */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <Card className="glass-morphism glass-morphism-hover gradient-border">
            <CardHeader className="pb-3">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <div className="p-2 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600">
                    <Server className="w-4 h-4 text-white" />
                  </div>
                  <CardTitle className="text-sm font-medium">Servers</CardTitle>
                </div>
                <Badge className="status-online text-xs">
                  {servers.filter(s => s.status === 'online').length}/{servers.length}
                </Badge>
              </div>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">{servers.length}</div>
              <p className="text-xs text-muted-foreground mt-1">Total Systems</p>
            </CardContent>
          </Card>

          <Card className="glass-morphism glass-morphism-hover gradient-border">
            <CardHeader className="pb-3">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <div className="p-2 rounded-lg bg-gradient-to-br from-green-500 to-green-600">
                    <Globe className="w-4 h-4 text-white" />
                  </div>
                  <CardTitle className="text-sm font-medium">Applications</CardTitle>
                </div>
                <Badge className="status-online text-xs">
                  {applications.filter(a => a.status === 'healthy').length}/{applications.length}
                </Badge>
              </div>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">{applications.length}</div>
              <p className="text-xs text-muted-foreground mt-1">Active Applications</p>
            </CardContent>
          </Card>

          <Card className="glass-morphism glass-morphism-hover gradient-border">
            <CardHeader className="pb-3">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <div className="p-2 rounded-lg bg-gradient-to-br from-purple-500 to-purple-600">
                    <Webhook className="w-4 h-4 text-white" />
                  </div>
                  <CardTitle className="text-sm font-medium">Webhooks</CardTitle>
                </div>
                <Badge className="status-online text-xs">
                  {webhooks.filter(w => w.status === 'active').length}/{webhooks.length}
                </Badge>
              </div>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">{webhooks.length}</div>
              <p className="text-xs text-muted-foreground mt-1">Active Webhooks</p>
            </CardContent>
          </Card>

          <Card className="glass-morphism glass-morphism-hover gradient-border">
            <CardHeader className="pb-3">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <div className="p-2 rounded-lg bg-gradient-to-br from-orange-500 to-orange-600">
                    <GitBranch className="w-4 h-4 text-white" />
                  </div>
                  <CardTitle className="text-sm font-medium">Workflows</CardTitle>
                </div>
                <Badge className="status-warning text-xs">
                  {workflows.filter(w => w.status === 'running').length} Running
                </Badge>
              </div>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">{workflows.length}</div>
              <p className="text-xs text-muted-foreground mt-1">Active Workflows</p>
            </CardContent>
          </Card>
        </div>

        {/* Main Content Tabs */}
        <Tabs value={activeTab} onValueChange={setActiveTab} className="space-y-4">
          <TabsList className="glass-morphism w-full h-12 p-1 grid grid-cols-9">
            <TabsTrigger value="overview" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">Overview</TabsTrigger>
            <TabsTrigger value="servers" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">Servers</TabsTrigger>
            <TabsTrigger value="applications" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">Applications</TabsTrigger>
            <TabsTrigger value="apis" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">APIs</TabsTrigger>
            <TabsTrigger value="webhooks" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">Webhooks</TabsTrigger>
            <TabsTrigger value="workflows" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">Workflows</TabsTrigger>
            <TabsTrigger value="ai-analytics" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">AI Analytics</TabsTrigger>
            <TabsTrigger value="team" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">Team</TabsTrigger>
            <TabsTrigger value="export" className="data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white">Export</TabsTrigger>
          </TabsList>

          {/* Overview Tab */}
          <TabsContent value="overview" className="space-y-4">
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
              {/* System Health */}
              <Card className="lg:col-span-2">
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <Activity className="w-5 h-5" />
                    System Health Overview
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-4">
                    <div className="flex items-center justify-between">
                      <span className="text-sm font-medium">Overall Health</span>
                      <span className="text-sm text-slate-600 dark:text-slate-400">{overallHealth}%</span>
                    </div>
                    <Progress value={overallHealth} className="h-2" />
                    
                    <div className="grid grid-cols-2 gap-4 mt-4">
                      <div className="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                        <div className="text-2xl font-bold text-green-600 dark:text-green-400">
                          {servers.filter(s => s.status === 'online').length}
                        </div>
                        <p className="text-xs text-slate-600 dark:text-slate-400">Online Servers</p>
                      </div>
                      <div className="text-center p-4 bg-red-50 dark:bg-red-900/20 rounded-lg">
                        <div className="text-2xl font-bold text-red-600 dark:text-red-400">
                          {alerts.filter(a => !a.acknowledged).length}
                        </div>
                        <p className="text-xs text-slate-600 dark:text-slate-400">Active Alerts</p>
                      </div>
                    </div>
                  </div>
                </CardContent>
              </Card>

              {/* Recent Alerts */}
              <Card>
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <Bell className="w-5 h-5" />
                    Recent Alerts
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <ScrollArea className="h-64">
                    <div className="space-y-3">
                      {alerts.slice(0, 5).map((alert) => (
                        <div 
                          key={alert.id} 
                          className="flex items-start gap-3 p-3 rounded-lg border dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer transition-colors"
                          onClick={() => handleAlertClick(alert)}
                        >
                          <div className={getStatusColor(alert.severity)}>
                            {getStatusIcon(alert.severity)}
                          </div>
                          <div className="flex-1 min-w-0">
                            <p className="text-sm font-medium truncate">{alert.title}</p>
                            <p className="text-xs text-slate-600 dark:text-slate-400 truncate">{alert.message}</p>
                            <p className="text-xs text-slate-400 dark:text-slate-500 mt-1">
                              {new Date(alert.timestamp).toLocaleTimeString()}
                            </p>
                          </div>
                          <div className="flex items-center gap-2">
                            <Badge variant={getSeverityColor(alert.severity)} className="text-xs">
                              {alert.severity}
                            </Badge>
                            {!alert.acknowledged && (
                              <Button
                                size="sm"
                                variant="outline"
                                onClick={(e) => {
                                  e.stopPropagation();
                                  handleAcknowledgeAlert(alert.id);
                                }}
                              >
                                Ack
                              </Button>
                            )}
                          </div>
                        </div>
                      ))}
                    </div>
                  </ScrollArea>
                </CardContent>
              </Card>
            </div>

            {/* Live Data Flow */}
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Radio className="w-5 h-5" />
                  Live Data Flow
                </CardTitle>
              </CardHeader>
              <CardContent>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div className="text-center p-4 border rounded-lg dark:border-slate-700">
                    <div className="flex items-center justify-center gap-2 mb-2">
                      <Download className="w-4 h-4 text-blue-600 dark:text-blue-400" />
                      <span className="text-sm font-medium">Incoming Requests</span>
                    </div>
                    <div className="text-2xl font-bold text-blue-600 dark:text-blue-400">1,247</div>
                    <p className="text-xs text-slate-600 dark:text-slate-400">per minute</p>
                  </div>
                  <div className="text-center p-4 border rounded-lg dark:border-slate-700">
                    <div className="flex items-center justify-center gap-2 mb-2">
                      <Upload className="w-4 h-4 text-green-600 dark:text-green-400" />
                      <span className="text-sm font-medium">Outgoing Responses</span>
                    </div>
                    <div className="text-2xl font-bold text-green-600 dark:text-green-400">1,231</div>
                    <p className="text-xs text-slate-600 dark:text-slate-400">per minute</p>
                  </div>
                  <div className="text-center p-4 border rounded-lg dark:border-slate-700">
                    <div className="flex items-center justify-center gap-2 mb-2">
                      <Package className="w-4 h-4 text-purple-600 dark:text-purple-400" />
                      <span className="text-sm font-medium">Data Processed</span>
                    </div>
                    <div className="text-2xl font-bold text-purple-600 dark:text-purple-400">2.4 GB</div>
                    <p className="text-xs text-slate-600 dark:text-slate-400">last hour</p>
                  </div>
                </div>
              </CardContent>
            </Card>
          </TabsContent>

          {/* Servers Tab */}
          <TabsContent value="servers" className="space-y-4">
            <div className="flex justify-between items-center">
              <h3 className="text-lg font-semibold">Server Infrastructure</h3>
              <Button 
                onClick={() => setShowServerForm(true)}
                className="bg-gradient-to-r from-blue-500 to-cyan-400 hover:from-blue-600 hover:to-cyan-500"
              >
                <Plus className="w-4 h-4 mr-2" />
                Add Server
              </Button>
            </div>
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
              {servers.map((server) => (
                <Card key={server.id} className="hover:shadow-md transition-shadow">
                  <CardHeader>
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <div className={getStatusColor(server.status)}>
                          {server.status === 'online' ? <Wifi className="w-5 h-5" /> : <WifiOff className="w-5 h-5" />}
                        </div>
                        <div>
                          <CardTitle className="text-lg">{server.name}</CardTitle>
                          <CardDescription>{server.host}:{server.port}</CardDescription>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <Badge variant={server.status === 'online' ? 'default' : 'secondary'}>
                          {server.status}
                        </Badge>
                        <Button variant="ghost" size="sm">
                          <Settings className="w-4 h-4" />
                        </Button>
                      </div>
                    </div>
                  </CardHeader>
                  <CardContent>
                    <div className="space-y-3">
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <div className="flex items-center justify-between text-sm">
                            <span className="text-slate-600 dark:text-slate-400">CPU</span>
                            <span className="font-medium">{server.cpu}%</span>
                          </div>
                          <Progress value={server.cpu} className="h-1 mt-1" />
                        </div>
                        <div>
                          <div className="flex items-center justify-between text-sm">
                            <span className="text-slate-600 dark:text-slate-400">Memory</span>
                            <span className="font-medium">{server.memory}%</span>
                          </div>
                          <Progress value={server.memory} className="h-1 mt-1" />
                        </div>
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <div className="flex items-center justify-between text-sm">
                            <span className="text-slate-600 dark:text-slate-400">Disk</span>
                            <span className="font-medium">{server.disk}%</span>
                          </div>
                          <Progress value={server.disk} className="h-1 mt-1" />
                        </div>
                        <div className="text-sm">
                          <div className="flex items-center justify-between">
                            <span className="text-slate-600 dark:text-slate-400">Response</span>
                            <span className="font-medium">{server.responseTime}ms</span>
                          </div>
                        </div>
                      </div>
                      <div className="flex items-center justify-between text-xs text-slate-500 dark:text-slate-400">
                        <span>Uptime: {server.uptime}</span>
                        <span>Last check: {new Date(server.lastCheck).toLocaleTimeString()}</span>
                      </div>
                      <div className="flex items-center justify-between text-xs text-slate-500 dark:text-slate-400">
                        <span className="flex items-center gap-1">
                          <MapPin className="w-3 h-3" />
                          {server.location}
                        </span>
                        <span className="flex items-center gap-1">
                          <Terminal className="w-3 h-3" />
                          {server.os}
                        </span>
                      </div>
                      <div className="flex flex-wrap gap-1">
                        {server.tags.map((tag, index) => (
                          <Badge key={index} variant="outline" className="text-xs">
                            {tag}
                          </Badge>
                        ))}
                      </div>
                      <div className="flex gap-2">
                        <Button size="sm" variant="outline" onClick={() => handleServerAction(server.id, 'restart')}>
                          <RefreshCw className="w-3 h-3 mr-1" />
                          Restart
                        </Button>
                        <Button size="sm" variant="outline" onClick={() => handleServerAction(server.id, 'stop')}>
                          <Pause className="w-3 h-3 mr-1" />
                          Stop
                        </Button>
                        <Button size="sm" variant="outline">
                          <Terminal className="w-3 h-3 mr-1" />
                          SSH
                        </Button>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </TabsContent>

          {/* Applications Tab */}
          <TabsContent value="applications" className="space-y-4">
            <div className="flex justify-between items-center">
              <h3 className="text-lg font-semibold">Applications Monitoring</h3>
              <Button 
                onClick={() => setShowAppForm(true)}
                className="bg-gradient-to-r from-blue-500 to-cyan-400 hover:from-blue-600 hover:to-cyan-500"
              >
                <Plus className="w-4 h-4 mr-2" />
                Add Application
              </Button>
            </div>
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
              {applications.map((app) => (
                <Card key={app.id} className="hover:shadow-md transition-shadow">
                  <CardHeader>
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-2">
                        <div className={getStatusColor(app.status)}>
                          {getStatusIcon(app.status)}
                        </div>
                        <CardTitle className="text-lg">{app.name}</CardTitle>
                      </div>
                      <Badge variant={app.status === 'healthy' ? 'default' : 'secondary'}>
                        {app.status}
                      </Badge>
                    </div>
                    <CardDescription>{app.type}  {app.serverName}</CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div className="space-y-3">
                      <div className="text-sm">
                        <div className="flex items-center justify-between">
                          <span className="text-slate-600 dark:text-slate-400">Endpoint</span>
                          <span className="font-medium truncate ml-2">{app.endpoint}</span>
                        </div>
                      </div>
                      <div className="grid grid-cols-2 gap-4 text-sm">
                        <div>
                          <span className="text-slate-600 dark:text-slate-400">Response Time</span>
                          <div className="font-medium">{app.responseTime}ms</div>
                        </div>
                        <div>
                          <span className="text-slate-600 dark:text-slate-400">Uptime</span>
                          <div className="font-medium">{app.uptime}%</div>
                        </div>
                      </div>
                      <div className="grid grid-cols-2 gap-4 text-sm">
                        <div>
                          <span className="text-slate-600 dark:text-slate-400">Version</span>
                          <div className="font-medium">{app.version}</div>
                        </div>
                        <div>
                          <span className="text-slate-600 dark:text-slate-400">Framework</span>
                          <div className="font-medium">{app.framework}</div>
                        </div>
                      </div>
                      <div className="flex items-center justify-between text-xs text-slate-500 dark:text-slate-400">
                        <span>Last check: {new Date(app.lastCheck).toLocaleTimeString()}</span>
                      </div>
                      <div className="flex flex-wrap gap-1">
                        {app.tags.map((tag, index) => (
                          <Badge key={index} variant="outline" className="text-xs">
                            {tag}
                          </Badge>
                        ))}
                      </div>
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </TabsContent>

          {/* APIs Tab */}
          <TabsContent value="apis" className="space-y-4">
            <div className="flex justify-between items-center">
              <h3 className="text-lg font-semibold">API Endpoints Monitoring</h3>
              <Button 
                onClick={() => setShowEndpointForm(true)}
                className="bg-gradient-to-r from-blue-500 to-cyan-400 hover:from-blue-600 hover:to-cyan-500"
              >
                <Plus className="w-4 h-4 mr-2" />
                Add Endpoint
              </Button>
            </div>
            <Card>
              <CardHeader>
                <CardTitle>API Endpoints Monitoring</CardTitle>
                <CardDescription>Real-time API performance and status tracking</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  {apiEndpoints.map((endpoint) => (
                    <div key={endpoint.id} className="flex items-center justify-between p-4 border rounded-lg dark:border-slate-700">
                      <div className="flex items-center gap-4">
                        <div className={getStatusColor(endpoint.success ? 'healthy' : 'unhealthy')}>
                          {getStatusIcon(endpoint.success ? 'healthy' : 'unhealthy')}
                        </div>
                        <div>
                          <div className="font-medium">{endpoint.name}</div>
                          <div className="text-sm text-slate-600 dark:text-slate-400">
                            {endpoint.method} {endpoint.url}
                          </div>
                          <div className="text-xs text-slate-500 dark:text-slate-500">
                            {endpoint.applicationName}
                          </div>
                        </div>
                      </div>
                      <div className="text-right">
                        <div className="flex items-center gap-2">
                          <Badge variant={endpoint.success ? 'default' : 'destructive'}>
                            {endpoint.status}
                          </Badge>
                          <span className="text-sm font-medium">{endpoint.responseTime}ms</span>
                        </div>
                        <div className="text-xs text-slate-500 dark:text-slate-500">
                          {new Date(endpoint.lastChecked).toLocaleTimeString()}
                        </div>
                        <div className="flex gap-2 mt-2">
                          <Button size="sm" variant="outline" onClick={() => handleApiTest(endpoint.id)}>
                            <Play className="w-3 h-3 mr-1" />
                            Test
                          </Button>
                          <Button size="sm" variant="outline">
                            <Eye className="w-3 h-3 mr-1" />
                            View
                          </Button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </CardContent>
            </Card>
          </TabsContent>

          {/* Webhooks Tab */}
          <TabsContent value="webhooks" className="space-y-4">
            <div className="flex justify-between items-center">
              <h3 className="text-lg font-semibold">Webhook Management</h3>
              <Button 
                onClick={() => setShowWebhookForm(true)}
                className="bg-gradient-to-r from-blue-500 to-cyan-400 hover:from-blue-600 hover:to-cyan-500"
              >
                <Plus className="w-4 h-4 mr-2" />
                Add Webhook
              </Button>
            </div>
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
              {webhooks.map((webhook) => (
                <Card key={webhook.id} className="hover:shadow-md transition-shadow">
                  <CardHeader>
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-2">
                        <div className={getStatusColor(webhook.status)}>
                          {getStatusIcon(webhook.status)}
                        </div>
                        <CardTitle className="text-lg">{webhook.name}</CardTitle>
                      </div>
                      <Badge variant={webhook.status === 'active' ? 'default' : 'secondary'}>
                        {webhook.status}
                      </Badge>
                    </div>
                    <CardDescription>{webhook.applicationName}</CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div className="space-y-3">
                      <div className="text-sm">
                        <div className="flex items-center justify-between">
                          <span className="text-slate-600 dark:text-slate-400">URL</span>
                          <span className="font-medium truncate ml-2">{webhook.url}</span>
                        </div>
                      </div>
                      <div className="grid grid-cols-2 gap-4 text-sm">
                        <div>
                          <span className="text-slate-600 dark:text-slate-400">Deliveries</span>
                          <div className="font-medium">{webhook.deliveries.toLocaleString()}</div>
                        </div>
                        <div>
                          <span className="text-slate-600 dark:text-slate-400">Success Rate</span>
                          <div className="font-medium">{webhook.successRate}%</div>
                        </div>
                      </div>
                      <div className="text-sm">
                        <span className="text-slate-600 dark:text-slate-400">Events</span>
                        <div className="flex flex-wrap gap-1 mt-1">
                          {webhook.events.map((event, index) => (
                            <Badge key={index} variant="outline" className="text-xs">
                              {event}
                            </Badge>
                          ))}
                        </div>
                      </div>
                      <div className="text-xs text-slate-500 dark:text-slate-400">
                        Last trigger: {new Date(webhook.lastTrigger).toLocaleString()}
                      </div>
                      <div className="flex gap-2">
                        <Button size="sm" variant="outline">
                          <Eye className="w-3 h-3 mr-1" />
                          Logs
                        </Button>
                        <Button size="sm" variant="outline">
                          <Edit className="w-3 h-3 mr-1" />
                          Edit
                        </Button>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </TabsContent>

          {/* Workflows Tab */}
          <TabsContent value="workflows" className="space-y-4">
            <div className="space-y-4">
              {workflows.map((workflow) => (
                <Card key={workflow.id}>
                  <CardHeader>
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <div className={getStatusColor(workflow.status)}>
                          {getStatusIcon(workflow.status)}
                        </div>
                        <div>
                          <CardTitle className="text-lg">{workflow.name}</CardTitle>
                          <CardDescription>
                            Started: {new Date(workflow.startedAt).toLocaleString()}
                          </CardDescription>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <Badge variant={workflow.status === 'running' ? 'default' : workflow.status === 'completed' ? 'default' : 'secondary'}>
                          {workflow.status}
                        </Badge>
                        <span className="text-sm font-medium">{workflow.duration}</span>
                      </div>
                    </div>
                  </CardHeader>
                  <CardContent>
                    <div className="space-y-3">
                      <div>
                        <div className="flex items-center justify-between text-sm mb-2">
                          <span>Progress</span>
                          <span>{workflow.progress}%</span>
                        </div>
                        <Progress value={workflow.progress} className="h-2" />
                      </div>
                      <div className="space-y-2">
                        {workflow.steps.map((step, index) => (
                          <div key={index} className="flex items-center justify-between p-2 rounded border dark:border-slate-700">
                            <div className="flex items-center gap-2">
                              <div className={getStatusColor(step.status)}>
                                {getStatusIcon(step.status)}
                              </div>
                              <span className="text-sm font-medium">{step.name}</span>
                            </div>
                            <div className="text-sm text-slate-600 dark:text-slate-400">
                              {step.duration || (step.status === 'running' ? 'Running...' : 'Pending')}
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </TabsContent>

          {/* AI Analytics Tab */}
          <TabsContent value="ai-analytics">
            <AIAnalytics />
          </TabsContent>

          {/* Team Tab */}
          <TabsContent value="team" className="space-y-4">
            <div className="flex justify-between items-center">
              <h3 className="text-lg font-semibold">Team Members</h3>
              <Button 
                onClick={() => setShowTeamMemberForm(true)}
                className="bg-gradient-to-r from-blue-500 to-cyan-400 hover:from-blue-600 hover:to-cyan-500"
              >
                <Plus className="w-4 h-4 mr-2" />
                Add Team Member
              </Button>
            </div>
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Users className="w-5 h-5" />
                  Team Members
                </CardTitle>
                <CardDescription>Current team status and availability</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                  {teamMembers.map((member) => (
                    <div key={member.id} className="flex items-center gap-3 p-4 border rounded-lg dark:border-slate-700">
                      <div className="relative">
                        <div className="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center">
                          <span className="text-white font-medium">
                            {member.name.split(' ').map(n => n[0]).join('')}
                          </span>
                        </div>
                        <div className={`absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white dark:border-slate-900 ${
                          member.status === 'online' ? 'bg-green-500' :
                          member.status === 'busy' ? 'bg-yellow-500' : 'bg-gray-400'
                        }`} />
                      </div>
                      <div className="flex-1">
                        <div className="font-medium">{member.name}</div>
                        <div className="text-sm text-slate-600 dark:text-slate-400">{member.role}</div>
                        <div className="text-xs text-slate-500 dark:text-slate-500">{member.email}</div>
                      </div>
                    </div>
                  ))}
                </div>
              </CardContent>
            </Card>
          </TabsContent>

          {/* Export Tab */}
          <TabsContent value="export">
            <DataExport />
          </TabsContent>
        </Tabs>

        {/* Alert Details Modal */}
        {showAlertDetails && selectedAlert && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <Card className="w-full max-w-2xl max-h-[80vh] overflow-y-auto m-4">
              <CardHeader>
                <div className="flex items-center justify-between">
                  <CardTitle className="flex items-center gap-2">
                    <AlertTriangle className="w-5 h-5" />
                    Alert Details
                  </CardTitle>
                  <Button variant="ghost" size="sm" onClick={() => setShowAlertDetails(false)}>
                    
                  </Button>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium text-slate-600 dark:text-slate-400">Title</label>
                    <p className="font-semibold">{selectedAlert.title}</p>
                  </div>
                  <div>
                    <label className="text-sm font-medium text-slate-600 dark:text-slate-400">Severity</label>
                    <Badge variant={getSeverityColor(selectedAlert.severity)}>
                      {selectedAlert.severity}
                    </Badge>
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium text-slate-600 dark:text-slate-400">Message</label>
                  <p className="mt-1 p-3 bg-slate-50 dark:bg-slate-800 rounded-lg">{selectedAlert.message}</p>
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium text-slate-600 dark:text-slate-400">Source</label>
                    <p className="font-medium">{selectedAlert.source}</p>
                  </div>
                  <div>
                    <label className="text-sm font-medium text-slate-600 dark:text-slate-400">Timestamp</label>
                    <p className="font-medium">{new Date(selectedAlert.timestamp).toLocaleString()}</p>
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium text-slate-600 dark:text-slate-400">Status</label>
                  <div className="mt-1">
                    <Badge variant={selectedAlert.acknowledged ? "default" : "secondary"}>
                      {selectedAlert.acknowledged ? "Acknowledged" : "Pending"}
                    </Badge>
                  </div>
                </div>
                
                {!selectedAlert.acknowledged && (
                  <div className="flex justify-end">
                    <Button onClick={() => {
                      handleAcknowledgeAlert(selectedAlert.id);
                      setShowAlertDetails(false);
                    }}>
                      Acknowledge Alert
                    </Button>
                  </div>
                )}
              </CardContent>
            </Card>
          </div>
        )}

        {/* Application Form Modal */}
        {showAppForm && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <Card className="w-full max-w-2xl max-h-[80vh] overflow-y-auto m-4">
              <CardHeader>
                <div className="flex items-center justify-between">
                  <CardTitle>Add New Application</CardTitle>
                  <Button variant="ghost" size="sm" onClick={() => setShowAppForm(false)}>
                    
                  </Button>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Application Name</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.name}
                      onChange={(e) => setNewApp({...newApp, name: e.target.value})}
                      placeholder="My Application"
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Version</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.version}
                      onChange={(e) => setNewApp({...newApp, version: e.target.value})}
                      placeholder="1.0.0"
                    />
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Description</label>
                  <textarea
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newApp.description}
                    onChange={(e) => setNewApp({...newApp, description: e.target.value})}
                    placeholder="Application description"
                    rows={3}
                  />
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Repository URL</label>
                    <input
                      type="url"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.repository}
                      onChange={(e) => setNewApp({...newApp, repository: e.target.value})}
                      placeholder="https://github.com/user/repo"
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Owner</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.owner}
                      onChange={(e) => setNewApp({...newApp, owner: e.target.value})}
                      placeholder="Team or person responsible"
                    />
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Health Check URL</label>
                  <input
                    type="url"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newApp.healthCheckUrl}
                    onChange={(e) => setNewApp({...newApp, healthCheckUrl: e.target.value})}
                    placeholder="https://app.example.com/health"
                  />
                </div>
                
                <div className="grid grid-cols-3 gap-4">
                  <div>
                    <label className="text-sm font-medium">Check Interval (sec)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.healthCheckInterval}
                      onChange={(e) => setNewApp({...newApp, healthCheckInterval: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Response Threshold (ms)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.responseTimeThreshold}
                      onChange={(e) => setNewApp({...newApp, responseTimeThreshold: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Error Threshold (%)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.errorRateThreshold}
                      onChange={(e) => setNewApp({...newApp, errorRateThreshold: parseInt(e.target.value)})}
                    />
                  </div>
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Environment</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.environment}
                      onChange={(e) => setNewApp({...newApp, environment: e.target.value as any})}
                    >
                      <option value="production">Production</option>
                      <option value="staging">Staging</option>
                      <option value="development">Development</option>
                    </select>
                  </div>
                  <div>
                    <label className="text-sm font-medium">Status</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newApp.status}
                      onChange={(e) => setNewApp({...newApp, status: e.target.value as any})}
                    >
                      <option value="active">Active</option>
                      <option value="inactive">Inactive</option>
                    </select>
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Tags (comma-separated)</label>
                  <input
                    type="text"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newApp.tags}
                    onChange={(e) => setNewApp({...newApp, tags: e.target.value})}
                    placeholder="web, frontend, critical"
                  />
                </div>
                
                <div className="flex justify-end gap-2">
                  <Button variant="outline" onClick={() => setShowAppForm(false)}>
                    Cancel
                  </Button>
                  <Button onClick={handleAddApplication}>
                    Add Application
                  </Button>
                </div>
              </CardContent>
            </Card>
          </div>
        )}

        {/* Server Form Modal */}
        {showServerForm && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <Card className="w-full max-w-2xl max-h-[80vh] overflow-y-auto m-4">
              <CardHeader>
                <div className="flex items-center justify-between">
                  <CardTitle>Add New Server</CardTitle>
                  <Button variant="ghost" size="sm" onClick={() => setShowServerForm(false)}>
                    
                  </Button>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Server Name</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.name}
                      onChange={(e) => setNewServer({...newServer, name: e.target.value})}
                      placeholder="Production Web Server"
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Type</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.type}
                      onChange={(e) => setNewServer({...newServer, type: e.target.value as any})}
                    >
                      <option value="web">Web Server</option>
                      <option value="database">Database Server</option>
                      <option value="application">Application Server</option>
                      <option value="cache">Cache Server</option>
                    </select>
                  </div>
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Host/IP Address</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.host}
                      onChange={(e) => setNewServer({...newServer, host: e.target.value})}
                      placeholder="192.168.1.100 or server.example.com"
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Port</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.port}
                      onChange={(e) => setNewServer({...newServer, port: parseInt(e.target.value)})}
                      placeholder="80, 443, 22, etc."
                    />
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Description/Location</label>
                  <input
                    type="text"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newServer.description}
                    onChange={(e) => setNewServer({...newServer, description: e.target.value})}
                    placeholder="US East - Production Environment"
                  />
                </div>
                
                <div>
                  <label className="text-sm font-medium">Health Check URL</label>
                  <input
                    type="url"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newServer.healthCheckUrl}
                    onChange={(e) => setNewServer({...newServer, healthCheckUrl: e.target.value})}
                    placeholder="https://server.example.com/health"
                  />
                </div>
                
                <div className="grid grid-cols-3 gap-4">
                  <div>
                    <label className="text-sm font-medium">CPU Cores</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.cpuCores}
                      onChange={(e) => setNewServer({...newServer, cpuCores: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Memory (GB)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.memory}
                      onChange={(e) => setNewServer({...newServer, memory: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Storage (GB)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.storage}
                      onChange={(e) => setNewServer({...newServer, storage: parseInt(e.target.value)})}
                    />
                  </div>
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Health Check Interval (sec)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.healthCheckInterval}
                      onChange={(e) => setNewServer({...newServer, healthCheckInterval: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Response Time Threshold (ms)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.responseTimeThreshold}
                      onChange={(e) => setNewServer({...newServer, responseTimeThreshold: parseInt(e.target.value)})}
                    />
                  </div>
                </div>
                
                <div className="grid grid-cols-3 gap-4">
                  <div>
                    <label className="text-sm font-medium">CPU Threshold (%)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.cpuThreshold}
                      onChange={(e) => setNewServer({...newServer, cpuThreshold: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Memory Threshold (%)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.memoryThreshold}
                      onChange={(e) => setNewServer({...newServer, memoryThreshold: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Disk Threshold (%)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newServer.diskThreshold}
                      onChange={(e) => setNewServer({...newServer, diskThreshold: parseInt(e.target.value)})}
                    />
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Tags (comma-separated)</label>
                  <input
                    type="text"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newServer.tags}
                    onChange={(e) => setNewServer({...newServer, tags: e.target.value})}
                    placeholder="production, web, critical"
                  />
                </div>
                
                <div className="flex justify-end gap-2">
                  <Button variant="outline" onClick={() => setShowServerForm(false)}>
                    Cancel
                  </Button>
                  <Button onClick={handleAddServerSubmit}>
                    Add Server
                  </Button>
                </div>
              </CardContent>
            </Card>
          </div>
        )}

        {/* API Endpoint Form Modal */}
        {showEndpointForm && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <Card className="w-full max-w-2xl max-h-[80vh] overflow-y-auto m-4">
              <CardHeader>
                <div className="flex items-center justify-between">
                  <CardTitle>Add API Endpoint</CardTitle>
                  <Button variant="ghost" size="sm" onClick={() => setShowEndpointForm(false)}>
                    
                  </Button>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Endpoint Name</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.name}
                      onChange={(e) => setNewEndpoint({...newEndpoint, name: e.target.value})}
                      placeholder="Get User Profile"
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">HTTP Method</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.method}
                      onChange={(e) => setNewEndpoint({...newEndpoint, method: e.target.value as any})}
                    >
                      <option value="GET">GET</option>
                      <option value="POST">POST</option>
                      <option value="PUT">PUT</option>
                      <option value="DELETE">DELETE</option>
                      <option value="PATCH">PATCH</option>
                    </select>
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Endpoint URL</label>
                  <input
                    type="url"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newEndpoint.url}
                    onChange={(e) => setNewEndpoint({...newEndpoint, url: e.target.value})}
                    placeholder="https://api.example.com/users/{id}"
                  />
                </div>
                
                <div>
                  <label className="text-sm font-medium">Description</label>
                  <textarea
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newEndpoint.description}
                    onChange={(e) => setNewEndpoint({...newEndpoint, description: e.target.value})}
                    placeholder="What this endpoint does"
                    rows={3}
                  />
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Application</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.applicationId}
                      onChange={(e) => setNewEndpoint({...newEndpoint, applicationId: e.target.value})}
                    >
                      <option value="">Select Application</option>
                      {applications.map(app => (
                        <option key={app.id} value={app.id}>{app.name}</option>
                      ))}
                    </select>
                  </div>
                  <div>
                    <label className="text-sm font-medium">Expected Status Code</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.expectedStatus}
                      onChange={(e) => setNewEndpoint({...newEndpoint, expectedStatus: parseInt(e.target.value)})}
                      placeholder="200"
                    />
                  </div>
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Timeout (ms)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.timeout}
                      onChange={(e) => setNewEndpoint({...newEndpoint, timeout: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Check Interval (sec)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.checkInterval}
                      onChange={(e) => setNewEndpoint({...newEndpoint, checkInterval: parseInt(e.target.value)})}
                    />
                  </div>
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Authentication</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.authentication}
                      onChange={(e) => setNewEndpoint({...newEndpoint, authentication: e.target.value as any})}
                    >
                      <option value="none">None</option>
                      <option value="bearer">Bearer Token</option>
                      <option value="basic">Basic Auth</option>
                      <option value="api-key">API Key</option>
                    </select>
                  </div>
                  <div>
                    <label className="text-sm font-medium">Alert Threshold</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newEndpoint.alertThreshold}
                      onChange={(e) => setNewEndpoint({...newEndpoint, alertThreshold: parseInt(e.target.value)})}
                      placeholder="Number of failures before alert"
                    />
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Headers (JSON format)</label>
                  <textarea
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800 font-mono text-sm"
                    value={newEndpoint.headers}
                    onChange={(e) => setNewEndpoint({...newEndpoint, headers: e.target.value})}
                    placeholder='{"Content-Type": "application/json"}'
                    rows={3}
                  />
                </div>
                
                <div className="flex justify-end gap-2">
                  <Button variant="outline" onClick={() => setShowEndpointForm(false)}>
                    Cancel
                  </Button>
                  <Button onClick={handleAddEndpoint}>
                    Add Endpoint
                  </Button>
                </div>
              </CardContent>
            </Card>
          </div>
        )}

        {/* Webhook Form Modal */}
        {showWebhookForm && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <Card className="w-full max-w-2xl max-h-[80vh] overflow-y-auto m-4">
              <CardHeader>
                <div className="flex items-center justify-between">
                  <CardTitle>Add Webhook</CardTitle>
                  <Button variant="ghost" size="sm" onClick={() => setShowWebhookForm(false)}>
                    
                  </Button>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Webhook Name</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newWebhook.name}
                      onChange={(e) => setNewWebhook({...newWebhook, name: e.target.value})}
                      placeholder="Payment Events"
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Application</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newWebhook.applicationId}
                      onChange={(e) => setNewWebhook({...newWebhook, applicationId: e.target.value})}
                    >
                      <option value="">Select Application</option>
                      {applications.map(app => (
                        <option key={app.id} value={app.id}>{app.name}</option>
                      ))}
                    </select>
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Webhook URL</label>
                  <input
                    type="url"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newWebhook.url}
                    onChange={(e) => setNewWebhook({...newWebhook, url: e.target.value})}
                    placeholder="https://webhook.example.com/events"
                  />
                </div>
                
                <div>
                  <label className="text-sm font-medium">Description</label>
                  <textarea
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newWebhook.description}
                    onChange={(e) => setNewWebhook({...newWebhook, description: e.target.value})}
                    placeholder="What this webhook handles"
                    rows={3}
                  />
                </div>
                
                <div>
                  <label className="text-sm font-medium">Events (comma-separated)</label>
                  <input
                    type="text"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newWebhook.events.join(', ')}
                    onChange={(e) => setNewWebhook({...newWebhook, events: e.target.value.split(',').map(s => s.trim()).filter(Boolean)})}
                    placeholder="payment.success, payment.failed, user.created"
                  />
                </div>
                
                <div>
                  <label className="text-sm font-medium">Secret (optional)</label>
                  <input
                    type="password"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newWebhook.secret}
                    onChange={(e) => setNewWebhook({...newWebhook, secret: e.target.value})}
                    placeholder="whsec_..."
                  />
                </div>
                
                <div className="grid grid-cols-3 gap-4">
                  <div>
                    <label className="text-sm font-medium">Retry Attempts</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newWebhook.retryAttempts}
                      onChange={(e) => setNewWebhook({...newWebhook, retryAttempts: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Timeout (ms)</label>
                    <input
                      type="number"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newWebhook.timeout}
                      onChange={(e) => setNewWebhook({...newWebhook, timeout: parseInt(e.target.value)})}
                    />
                  </div>
                  <div>
                    <label className="text-sm font-medium">Status</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newWebhook.active ? 'active' : 'inactive'}
                      onChange={(e) => setNewWebhook({...newWebhook, active: e.target.value === 'active'})}
                    >
                      <option value="active">Active</option>
                      <option value="inactive">Inactive</option>
                    </select>
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Headers (JSON format)</label>
                  <textarea
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800 font-mono text-sm"
                    value={newWebhook.headers}
                    onChange={(e) => setNewWebhook({...newWebhook, headers: e.target.value})}
                    placeholder='{"User-Agent": "MyApp/1.0"}'
                    rows={3}
                  />
                </div>
                
                <div className="flex justify-end gap-2">
                  <Button variant="outline" onClick={() => setShowWebhookForm(false)}>
                    Cancel
                  </Button>
                  <Button onClick={handleAddWebhook}>
                    Add Webhook
                  </Button>
                </div>
              </CardContent>
            </Card>
          </div>
        )}

        {/* Team Member Form Modal */}
        {showTeamMemberForm && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <Card className="w-full max-w-lg max-h-[80vh] overflow-y-auto m-4">
              <CardHeader>
                <div className="flex items-center justify-between">
                  <CardTitle>Add Team Member</CardTitle>
                  <Button variant="ghost" size="sm" onClick={() => setShowTeamMemberForm(false)}>
                    
                  </Button>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <div>
                  <label className="text-sm font-medium">Full Name</label>
                  <input
                    type="text"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newTeamMember.name}
                    onChange={(e) => setNewTeamMember({...newTeamMember, name: e.target.value})}
                    placeholder="John Doe"
                  />
                </div>
                
                <div>
                  <label className="text-sm font-medium">Email Address</label>
                  <input
                    type="email"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newTeamMember.email}
                    onChange={(e) => setNewTeamMember({...newTeamMember, email: e.target.value})}
                    placeholder="john.doe@example.com"
                  />
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm font-medium">Role</label>
                    <select
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newTeamMember.role}
                      onChange={(e) => setNewTeamMember({...newTeamMember, role: e.target.value as any})}
                    >
                      <option value="member">Member</option>
                      <option value="admin">Admin</option>
                      <option value="developer">Developer</option>
                      <option value="viewer">Viewer</option>
                    </select>
                  </div>
                  <div>
                    <label className="text-sm font-medium">Department</label>
                    <input
                      type="text"
                      className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                      value={newTeamMember.department}
                      onChange={(e) => setNewTeamMember({...newTeamMember, department: e.target.value})}
                      placeholder="Engineering"
                    />
                  </div>
                </div>
                
                <div>
                  <label className="text-sm font-medium">Permissions (comma-separated)</label>
                  <input
                    type="text"
                    className="w-full mt-1 p-2 border rounded-lg dark:border-slate-700 dark:bg-slate-800"
                    value={newTeamMember.permissions.join(', ')}
                    onChange={(e) => setNewTeamMember({...newTeamMember, permissions: e.target.value.split(',').map(s => s.trim()).filter(Boolean)})}
                    placeholder="read, write, delete"
                  />
                </div>
                
                <div className="flex justify-end gap-2">
                  <Button variant="outline" onClick={() => setShowTeamMemberForm(false)}>
                    Cancel
                  </Button>
                  <Button onClick={handleAddTeamMember}>
                    Add Team Member
                  </Button>
                </div>
              </CardContent>
            </Card>
          </div>
        )}
      </div>
    </div>
  );
}